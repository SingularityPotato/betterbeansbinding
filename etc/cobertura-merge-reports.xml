<?xml version="1.0" encoding="UTF-8"?>
<project name="cobertura-merge-reports" basedir="..">

    <property name="cobertura.dir" value="/Users/fritz/Business/Tidalwave/Projects/OpenBlueSky/trunk/src/tools/cobertura"/>

    <target name="-cobertura-init">
        <taskdef classpath="${plugin_classpath}" resource="tasks.properties"/>

        <property name="cobertura.report.dir" value="${basedir}/target/site/cobertura"/>
        <property name="cobertura.datafile" value="${cobertura.report.dir}/global-cobertura.ser"/>

        <delete file="${cobertura.datafile}" failonerror="false"/>
        <delete dir="${cobertura.report.dir}" failonerror="false"/>
        <mkdir dir="${cobertura.report.dir}"/>
    </target>

    <!-- ==============================================================================

    Creates a global coverage report

    =============================================================================== -->
    <target name="merge-reports" depends="-cobertura-init">
        <delete file="${cobertura.datafile}" failonerror="false"/>
        <cobertura-merge datafile="${cobertura.datafile}">
            <fileset dir=".">
                <include name="**/cobertura.ser" />
            </fileset>
        </cobertura-merge>
<!--
        <cobertura-report datafile="${cobertura.datafile}" srcdir="${src.dir}" destdir="${cobertura.report.dir}">
            <fileset dir=".">
                <include name="**/*.java" />
            </fileset>
        </cobertura-report> 
-->
        <cobertura-report datafile="${cobertura.datafile}" srcdir="${src.dir}" destdir="${cobertura.report.dir}" format="xml">
            <fileset dir=".">
                <include name="**/*.java" />
            </fileset>
        </cobertura-report> 
    </target>

</project>
